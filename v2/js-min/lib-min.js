function isUpper(e){return"A".charCodeAt(0)<=e&&e<="Z".charCodeAt(0)}function isLower(e){return"a".charCodeAt(0)<=e&&e<="z".charCodeAt(0)}function isDigit(e){return"0".charCodeAt(0)<=e&&e<="9".charCodeAt(0)}function is_ok_pw(e){var t=0,n=0,r=0,i=0,s=0,o=0,u;for(n=0;n<min_size;n++){u=e.charCodeAt(n);if(isDigit(u))s++;else if(isUpper(u))r++;else{if(!isLower(u))return!1;i++}}if(s===0||i===0||r===0||s>5||i>5||r>5)return!1;for(;n<max_size;n++){u=e.charCodeAt(n);if(!isDigit(u)&&!isUpper(u)&&!isLower(u))return!1}return!0}function find_class_to_sub(e){var t=e.length,n,r=0,i=0,s=0,o=0,u;for(n=0;n<min_size;n++)u=e.charCodeAt(n),isDigit(u)?s++:isUpper(u)?r++:isLower(u)&&i++;return i>=r&&i>=s?isLower:s>i&&s>=r?isDigit:isUpper}function v2_pwgen(e,t,n){e.compute_done=!1,e.DK=null;var r=CryptoJS,s=r.algo,o=r.lib,u=r.enc,a;if(!(a=e.state)){var f=s.HMAC.create(s.SHA512,e.passphrase),l=o.WordArray.create([1]),c=f.update(e.email).finalize(l);f.reset();var h=parseInt(e.secbits,10)+2,p=(1<<h)-1;e.state={hmac:f,block:c,intermediate:c,limit:p},e.iter=0,a=e.state}for(i=0;i<t&&e.iter<a.limit&&e.key==n.key;i++){a.intermediate=a.hmac.finalize(a.intermediate),a.hmac.reset();for(var d=0;d<a.block.words.length;d++)a.block.words[d]^=a.intermediate.words[d];e.iter++}return e.iter>=a.limit&&(e.DK=a.block.toString(u.Base64),e.compute_done=!0,e.state={}),e.compute_done}function v2_finish_compute(e,t){var n,r=null;for(n=0;!r;n++){var i=["OneShallPass v2.0",e.email,e.host,e.generation,n],s=i.join("; "),o=CryptoJS.HmacSHA512(s,e.DK),u=o.toString(CryptoJS.enc.Base64);is_ok_pw(u)&&(r=u)}return r}function v1_pwgen(e,t,n){e.generated_pw=null,e.compute_done=!1;var r=1<<parseInt(e.secbits,10),i;for(i=0;i<t&&!e.generated_pw&&e.key==n.key;i++){var s=["OneShallPass v1.0",e.email,e.host,e.generation,e.iter],o=s.join("; "),u=CryptoJS.HmacSHA512(o,e.passphrase),a=u.toString(),f=u.toString(CryptoJS.enc.Base64),l=parseInt(a.slice(a.length-8,a.length),16);l%r===0&&is_ok_pw(f)?e.generated_pw=f:e.iter++}var c=!!e.generated_pw;return e.compute_done=c,c}function translate_at_indices(e,t,n){var r=0,i=[],s;for(s=0;s<t.length;s++){var o=t[s];i.push(e.slice(r,o));var u=e.charAt(o),a=CryptoJS.enc.Base64._map.indexOf(u);u=n.charAt(a%n.length),i.push(u),r=o+1}return i.push(e.slice(r,e.length)),i.join("")}function add_syms_at_indices(e,t){var n="`~!@#$%^&*()-_+={}[]|;:,<>.?/";return translate_at_indices(e,t,n)}function add_syms(e,t){if(t<=0)return e;var n=find_class_to_sub(e),r,i=[];for(r=0;t>0&&r<min_size;r++){var s=e.charCodeAt(r);n(s)&&(t--,i.push(r))}return add_syms_at_indices(e,i)}var min_size=8,max_size=16;typeof exports!="undefined"&&(exports.add_syms=add_syms,exports.add_syms_at_indices=add_syms_at_indices,exports.v1_pwgen=v1_pwgen);